<!DOCTYPE html>
<html>
    <head>
        <title>Question</title>
        <meta charset="UTF-8">
    </head>
    <style>
        #control-rack{
            position: absolute;
            text-align: center;;
            bottom: 150px;
            left: 50%;
            transform: translateX(-50%);
            width: 2000px;
        }
        .control-button{
            position: relative;
            height: 100px;
            width: 500px;
            border-radius: 50px;
            border: none;
            margin-left: 200px;
            margin-right: 200px;
            font-size: 50px;
            text-justify: center;
            bottom: 0px;
            cursor: pointer;
        }
        .control-button:hover{
            bottom: 10px;
            transition: bottom 0.6s ease;
        }
        #arrow{
            position: absolute;
            bottom: 0px;
            top : 0px;
            left: 50px;
        }
        #quit{
            color: white;
            background-color: red;
        }
        #continue{
            color: purple;
            background-color: yellow;
        }
        #level{
            text-align: center;
            font-size: 40px;
            margin-top: 100px;
        }
        #dialog{
            position: absolute;
            left: 50%;
            transform: translateX(-50%);
            top: 150px;
            text-justify: center;
            font-size: 30px;
        }
        #question-card{
            top: 400px;
        }
        #choices-rack{
            display: flex; 
            width: 100%;
            align-items: center;
        }
        #question-display{
            font-size: 50px;
            margin-left: 20px;
        }
        .choices{
            font-size: 40px;
            margin: 20px;
            padding: 10px;
            border: 2px solid rgb(50, 50, 50);
            cursor: pointer;
        }
    </style>
    <body id="body">
        <h1 id="level"></h1>
        <p id="dialog"></p>
        <div id="control-rack">
            <button class="control-button" id="quit" onclick="quit();">é€€å‡ºéŠæˆ²</button>
            <span><button class="control-button" id="continue" onclick="clickingContinue();">ç¹¼çºŒ</button></span>
        </div>
        <div id='question-card'>
            <p id="question-display">å•é¡Œ ${questionNum}: ${questionKey}?</p>
            <div id="choices-rack">
                <button class='choices'>A. ${choices['A']}</button>
                <button class='choices'>B. ${choices['B']}</button>
                <button class='choices'>C. ${choices['C']}</button>
                <button class='choices'>D. ${choices['D']}</button>
            </div>
        </div>
        <script src="questioning.js"></script>
        <script>
            // import {questionKeysOfLV1} from './questioning.js';
            // import {questionKeysOfLV2} from './questioning.js';
            // import {questionKeysOfLV3} from './questioning.js';
            // import {questionKeysOfLV4} from './questioning.js';
            let i = 0;
            let level = 1;
            let questionKey;
            const contentOfDialogOfLV1 = 'æ–°å…µï¼Œå…ˆä¾†é»ç°¡å–®çš„åŸºç¤é¡Œï¼Œè­‰æ˜ä½ ä¸æ˜¯èª¤é—–çš„ï¼';
            const contentOfDialogOfLV2 = 'åŸºç¤çŸ¥è­˜é€šéï¼ä½ ç²å¾—äº†é€²å…¥ç¥èˆŸä¸­å¿ƒçš„è¨±å¯æ¬Šã€‚æ¥ä¸‹ä¾†çš„ä»»å‹™æ˜¯ç¢ºä¿è¼‰äººé£›èˆ¹èˆ‡ç©ºé–“ç«™çš„å®Œç¾å°æ¥ï¼Œè€ƒé©—ä½ å°æ ¸å¿ƒæŠ€è¡“çš„ç†è§£ï¼';
            const contentOfDialogOfLV3 = 'å¾ˆå¥½ï¼Œä½ å°è¼‰äººèˆªå¤©é«”ç³»å·²ç¶“æŒæ¡ï¼ç¾åœ¨æˆ‘å€‘é€²å…¥å«¦å¨¥å·¥ç¨‹ï¼Œç›®æ¨™æ˜¯æœˆçƒå’Œæ·±ç©ºã€‚å›ç­”é€™äº›é—œæ–¼è£œçµ¦èˆ‡æ¢æ¸¬çš„é¡Œç›®ï¼';
            const contentOfDialogOfLV4 = 'é›¢æˆåŠŸåªæœ‰ä¸€æ­¥ä¹‹é™ï¼æœ€çµ‚é—œå¡æ˜¯ç©ºé–“ç«™å’Œæœªä¾†æŠ€è¡“ã€‚å›ç­”é€™äº›é—œæ–¼é‡å‹ç™¼å°„å’Œæ·±ç©ºæ¢æ¸¬çš„é›£é¡Œï¼Œä½ å°±èƒ½æˆç‚ºæ­£å¼çš„èˆªå¤©å°ˆå®¶ï¼';
            const body = document.getElementById('body');
            const title = document.getElementById('level');
            let contentOfDialog;
            const levelTitles = ['ğŸŒŸ ç¬¬ä¸€ç´šï¼šæ–°å…µå ±åˆ°ï¼ˆç°¡å–®ï¼‰',];
            let questionNum = 1;
            let lengthOfContentOfDialog;
            function sleep(ms) {
                return new Promise(resolve => setTimeout(resolve, ms));
            }
            function setDialog(){
                title. innerHTML = levelTitles[level - 1];
                switch(level){
                    case 1:
                        contentOfDialog = contentOfDialogOfLV1;
                        break;
                    case 2:
                        contentOfDialog = contentOfDialogOfLV2;
                        break;
                    case 3:
                        contentOfDialog = contentOfDialogOfLV3;
                        break;
                    case 4:
                        contentOfDialog = contentOfDialogOfLV4;
                        break;
                    default:
                        contentOfDialog = 'ä½ çš„è¡¨ç¾ä»¤äººå°è±¡æ·±åˆ»ï¼Œæ–°å…µã€‚ä½ å·²ç¶“è­‰æ˜äº†è‡ªå·±å°ä¸­åœ‹èˆªå¤©äº‹æ¥­çš„æ·±åˆ»ç†è§£ã€‚é•·å¾ç«ç®­å·²ç¶“æº–å‚™å°±ç·’ï¼Œç¾åœ¨ï¼Œæº–å‚™å¥½è¿æ¥ä½ çš„ç¬¬ä¸€æ¬¡ç™¼å°„ä»»å‹™ï¼Œå»å¾æœæ˜Ÿè¾°å¤§æµ·å§ï¼';
                        break;
                }
                lengthOfContentOfDialog = contentOfDialog.length;
            }
            async function typeDialog(){
                setDialog();
                const blinkinterval = 100; 
                for (i = 0; i < lengthOfContentOfDialog; i++){
                    let blinkTimes = Math.round(Math.random() * 3);
                    for (let t = 0; t < blinkTimes; t++){
                        dialog.innerHTML += '|';
                        await sleep(blinkinterval);
                        dialog.innerHTML = dialog.innerHTML.replace('|', '');
                        await sleep(blinkinterval);
                    }
                    dialog.innerHTML += contentOfDialog[i] + '|';
                    dialog.innerHTML = dialog.innerHTML.replace('|', '');
                }
            }
            function generateQuestionCard(questionKey){
                let questionCardHTML;
                let symbols = ['A', 'B', 'C', 'D'];
                let options;
                let choices = {};
                shuttleArray(symbols);
                switch(level){
                    case 1:
                        options = questionsOfLV1[questionKey].incorrect;
                        options += questionsOfLV1[questionKey].correct;
                        shuttleArray(options);
                        for (let choiceIndex = 0; choiceIndex < 4; choiceIndex++){
                            choices[symbols[choiceIndex]] = options[choiceIndex];
                        }
                        questionCardHTML = `<div id='question-card'>
                                <h2>å•é¡Œ ${questionNum}: ${questionKey}?</h2>
                                <button class='choices'>A. ${choices['A']}</button>
                                <button class='choices'>B. ${choices['B']}</button>
                                <button class='choices'>C. ${choices['C']}</button>
                                <button class='choices'>D. ${choices['D']}</button>
                            </div>`
                }
            }
            function showQuestion(){
                for (let questionIndex = 1; questionIndex <= 20; questionIndex++){
                    questionNumOfInstantLV = questionIndex % 5;
                    switch(level){
                        case 1:
                            questionKey = questionKeysOfLV1.at(questionNumOfInstantLV - 1);
                            break;n
                        case 2:
                            questionKey = questionKeysOfLV2.at(questionNumOfInstantLV - 1);
                            break;
                        case 3:
                            questionKey = questionKeysOfLV3.at(questionNumOfInstantLV - 1);
                            break;
                        case 4:
                            questionKey = questionKeysOfLV4.at(questionNumOfInstantLV - 1);
                            break;
                        default:
                            break;
                    }
                    generateQuestionCard(questionKey);
                    questionNum += 1;
                }
            }
            function clickingContinue(){
                if (i == 0){
                    typeDialog();
                } else {
                    dialog.innerHTML = '';
                    showQuestion();
                }
            }
            // main
            typeDialog();
        </script>
    </body>
</html>